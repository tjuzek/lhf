# rapid development script
# written with AI assistance
# fill in the hf token in line 123 and the file paths in 129 and 130
from transformers import AutoTokenizer, AutoModelForCausalLM
import torch
import pandas as pd
import spacy


# Load the SpaCy language model
nlp = spacy.load("en_core_web_sm")
# Define the focal words
buzzword_weights = {"nuanced_ADJ": 8.34, "nuance_VERB": 6.3, "firstly_ADV": 4.79, "reliance_NOUN": 3.19, "generalizability_NOUN": 3.12, "underscore_VERB": 2.83, "radar_NOUN": 2.59, "staffing_NOUN": 2.03, "socioemotional_ADJ": 2.03, "multifacete_VERB": 1.85, "flake_NOUN": 1.66, "interoceptive_ADJ": 1.66, "vocabulary_ADJ": 1.66, "theanine_NOUN": 1.66, "secondly_ADV": 1.6, "finish_NOUN": 1.57, "daa_NOUN": 1.57, "necessitate_VERB": 1.48, "behavioral_NOUN": 1.48, "phospholipid_ADJ": 1.48, "rehabilitate_VERB": 1.48, "alm_NOUN": 1.48, "ensemble_ADJ": 1.38, "latent_NOUN": 1.38, "organ_ADJ": 1.38, "nanoalloy_NOUN": 1.38, "bereaved_ADJ": 1.38, "rarity_NOUN": 1.29, "biota_NOUN": 1.29, "festival_NOUN": 1.29, "viscoelastic_ADJ": 1.29, "emr_NOUN": 1.29, "transgender_NOUN": 1.29, "orangutan_NOUN": 1.29, "durability_NOUN": 1.25, "multifaceted_ADJ": 1.21, "perpetuate_VERB": 1.2, "uncharacterized_ADJ": 1.2, "promptly_ADV": 1.2, "PsA_NOUN": 1.2, "weathering_NOUN": 1.2, "empathetic_ADJ": 1.2, "slow_ADV": 1.2, "immersive_ADJ": 1.2, "boreal_ADJ": 1.2, "mainstreame_VERB": 1.2, "carnivorous_ADJ": 1.2, "revolutionize_VERB": 1.16, "equitable_ADJ": 1.15, "og_NOUN": 1.11, "remedy_NOUN": 1.11, "tubercle_NOUN": 1.11, "cucumber_NOUN": 1.11, "sphaericus_NOUN": 1.11, "diopter_NOUN": 1.08, "peroneal_ADJ": 1.06, "scalability_NOUN": 1.01, "fume_NOUN": 1.01, "plantation_NOUN": 1.01, "midwifery_ADJ": 1.01, "subaerial_ADJ": 1.01, "scale_ADJ": 1.01, "plastome_NOUN": 1.01, "lockdown_ADJ": 1.01, "conidia_NOUN": 1.01, "nca_NOUN": 1.01, "schizotypal_NOUN": 1.01, "vanadium_NOUN": 1.01, "dorsal_ADJ": 1.01, "advertising_NOUN": 1.01, "mesostructure_NOUN": 1.01, "frisian_ADJ": 1.01, "syntactic_ADJ": 1.01, "hungarian_ADJ": 1.01, "luts_ADJ": 1.01, "rotator_NOUN": 1.01, "betaine_NOUN": 1.01, "ocs_NOUN": 1.01, "uniformity_NOUN": 0.97, "sophisticated_ADJ": 0.95, "r201h_ADJ": 0.92, "β2_NOUN": 0.92, "linezolid_NOUN": 0.92, "persona_NOUN": 0.92, "personalize_VERB": 0.92, "biomineralization_NOUN": 0.92, "robustus_NOUN": 0.92, "contig_NOUN": 0.92, "converbal_ADJ": 0.92, "radioprotector_NOUN": 0.92, "ligamentous_ADJ": 0.92, "rounded_ADJ": 0.92, "workability_NOUN": 0.92, "ruminant_ADJ": 0.92, "socialisation_NOUN": 0.92, "nAChR2A_NOUN": 0.92, "pd1_ADJ": 0.92, "onion_NOUN": 0.92, "drl_NOUN": 0.92, "keratinous_ADJ": 0.92, "simplex_NOUN": 0.92, "fighter_NOUN": 0.92, "eugenol_NOUN": 0.92, "nonplatinum_ADJ": 0.92, "postfire_NOUN": 0.92, "circ_las1l_ADV": 0.92, "fpi_NOUN": 0.92, "standardization_NOUN": 0.9, "citric_NOUN": 0.87, "positive_NOUN": 0.86, "booster_NOUN": 0.83, "moth_NOUN": 0.83, "adrenergic_ADJ": 0.83, "bronchodilator_NOUN": 0.83, "opv_NOUN": 0.83, "minor_NOUN": 0.83, "flag_NOUN": 0.83, "haplogroup_NOUN": 0.83, "laryngoscopic_ADJ": 0.83, "appetite_ADJ": 0.83, "spark_VERB": 0.83, "fossil_ADJ": 0.83, "optoelectronic_NOUN": 0.83, "inductance_NOUN": 0.83, "neuromast_NOUN": 0.83, "unexplained_ADJ": 0.83, "geological_ADJ": 0.83, "detachment_ADJ": 0.83, "ecog_NOUN": 0.83, "sonographic_ADJ": 0.83, "naat_NOUN": 0.83, "2DEP_NOUN": 0.83, "laminate_NOUN": 0.83, "alike_ADV": 0.83, "biosphere_NOUN": 0.83, "notch_VERB": 0.83, "muciniphila_NOUN": 0.83, "ewe_NOUN": 0.83, "wd_NOUN": 0.83, "kawagutii_NOUN": 0.83, "cgmp_NOUN": 0.83, "bedding_ADJ": 0.83, "psychoactive_ADJ": 0.83, "aryldiazole_NOUN": 0.83, "ht2ars_NOUN": 0.83, "mineworker_NOUN": 0.83, "jail_NOUN": 0.83, "prioritize_VERB": 0.81, "thirdly_ADV": 0.79, "leverage_VERB": 0.79, "histamine_ADJ": 0.78, "workload_NOUN": 0.74, "judgmental_ADJ": 0.74, "fourthly_ADV": 0.74, "offset_VERB": 0.74, "epigenetic_NOUN": 0.74, "nanoparticle_VERB": 0.74, "oxysporum_NOUN": 0.74, "cholera_NOUN": 0.74, "monotonic_ADJ": 0.74, "pb_ADJ": 0.74, "epistasis_NOUN": 0.74, "payload_NOUN": 0.74, "cricket_NOUN": 0.74, "calving_NOUN": 0.74, "psychrotrophic_ADJ": 0.74, "clearing_NOUN": 0.74, "gestalt_NOUN": 0.74, "empathy_ADJ": 0.74, "biosecurity_NOUN": 0.74, "nitrogenase_NOUN": 0.74, "scar_VERB": 0.74, "warm_VERB": 0.74, "vegetate_VERB": 0.74, "fai_NOUN": 0.74, "abmd_NOUN": 0.74, "ats_ADJ": 0.74, "posturographic_ADJ": 0.74, "paramedic_NOUN": 0.74, "translatomic_NOUN": 0.74, "subproblem_NOUN": 0.74, "interrupt_VERB": 0.74, "bioformulation_NOUN": 0.74, "pooling_NOUN": 0.74, "msl_NOUN": 0.74, "dopant_NOUN": 0.74, "quasimetagenomic_ADJ": 0.74, "papaya_NOUN": 0.74, "merging_NOUN": 0.74, "plutonium_NOUN": 0.74, "glycopyrrolate_ADJ": 0.74, "haloperidol_NOUN": 0.74, "supercentenarian_NOUN": 0.74, "promedio_NOUN": 0.74, "millennial_ADJ": 0.74, "leiomodin_ADJ": 0.74, "tropomyosin_NOUN": 0.74, "marginalize_VERB": 0.7, "tdcs_NOUN": 0.7, "continued_ADJ": 0.7, "contractility_NOUN": 0.69, "preprocesse_VERB": 0.69, "ddcfdna_NOUN": 0.69, "avenue_NOUN": 0.65, "waveform_VERB": 0.64, "deflection_NOUN": 0.64, "pvl_NOUN": 0.64, "intuitive_ADJ": 0.64, "insert_ADJ": 0.64, "procedure_ADJ": 0.64, "fragmented_ADJ": 0.64, "repatriation_NOUN": 0.64, "oligomerization_NOUN": 0.64, "ordination_NOUN": 0.64, "shunting_NOUN": 0.64, "magnetoresistive_ADJ": 0.64, "topsoil_NOUN": 0.64, "multitaske_VERB": 0.64, "lapping_ADJ": 0.64, "beneficiary_NOUN": 0.64, "biotope_NOUN": 0.64, "nuance_NOUN": 0.64, "nmol_NOUN": 0.64, "decellularization_NOUN": 0.64, "chow_NOUN": 0.64, "outreach_NOUN": 0.64, "yolk_NOUN": 0.64, "carrying_NOUN": 0.64, "chiropractic_ADJ": 0.64, "h37rv_NOUN": 0.64, "audiological_ADJ": 0.64, "ontogenic_ADJ": 0.64, "intersectionality_NOUN": 0.64, "undifferentiated_ADJ": 0.64, "rbp_NOUN": 0.64, "tqd_NOUN": 0.64, "upgrading_NOUN": 0.64, "tourist_NOUN": 0.64, "lime_NOUN": 0.64, "fcγr_NOUN": 0.64, "asas_NOUN": 0.64, "calcite_ADJ": 0.64, "elafibranor_NOUN": 0.64, "aegyti_NOUN": 0.64, "game_ADJ": 0.64, "thiosemicarbazide_ADJ": 0.64, "cassavahsp21_NOUN": 0.64, "nucleoid_ADJ": 0.64, "AFib_NOUN": 0.64, "diphasic_ADJ": 0.64, "crucial_ADJ": 0.61, "hydrochloride_NOUN": 0.6, "underserved_ADJ": 0.6, "antigenic_ADJ": 0.6, "gfm_NOUN": 0.6, "batting_NOUN": 0.6, "pfm_NOUN": 0.6, "default_NOUN": 0.58, "empower_VERB": 0.57, "notably_ADV": 0.56, "rom_NOUN": 0.55, "redundancy_NOUN": 0.55, "adaptability_NOUN": 0.55, "luminescence_NOUN": 0.55, "batter_NOUN": 0.55, "guilt_NOUN": 0.55, "autonomy_NOUN": 0.55, "otter_NOUN": 0.53, "artifact_NOUN": 0.52, "irritation_NOUN": 0.52, "stomatal_ADJ": 0.52, "truffle_NOUN": 0.52, "precaution_NOUN": 0.52, "faceted_ADJ": 0.5, "disproportionately_ADV": 0.5, "uniformly_ADV": 0.5, "folate_NOUN": 0.5, "anesthesiologist_NOUN": 0.5, "aaa_NOUN": 0.5, "hypoglycemic_ADJ": 0.5, "initio_NOUN": 0.5, "tendon_NOUN": 0.5, "wf_NOUN": 0.5, "incineration_NOUN": 0.5, "microcapsule_NOUN": 0.5, "underlie_VERB": 0.5, "highlight_VERB": 0.49, "tax_NOUN": 0.49, "policymaker_NOUN": 0.48, "personalized_ADJ": 0.46, "convey_VERB": 0.46, "invest_VERB": 0.46, "selenoprotein_NOUN": 0.46, "superconducte_VERB": 0.46, "cm²_NOUN": 0.46, "oxytocin_NOUN": 0.46, "mentorship_NOUN": 0.46, "learner_NOUN": 0.46, "task_ADJ": 0.46, "nonviolent_ADJ": 0.46, "equilibrium_ADJ": 0.46, "disinfection_NOUN": 0.46, "garlic_ADJ": 0.46, "weaning_ADJ": 0.46, "pour_VERB": 0.46, "tsod_ADJ": 0.46, "polyaniline_NOUN": 0.46, "ppl_NOUN": 0.46, "itch_NOUN": 0.46, "generalizable_ADJ": 0.45, "annotation_NOUN": 0.45, "mitigate_VERB": 0.43, "accommodate_VERB": 0.43, "toolbox_NOUN": 0.43, "universally_ADV": 0.43, "autocorrelation_NOUN": 0.43, "chlorpyrifos_NOUN": 0.43, "valuable_ADJ": 0.43, "misfolde_VERB": 0.41, "adsorber_NOUN": 0.41, "trainer_NOUN": 0.41, "communicable_ADJ": 0.41, "thermostability_NOUN": 0.41, "FRIL_NOUN": 0.41, "capping_NOUN": 0.41, "pneumatic_ADJ": 0.41, "biometric_ADJ": 0.41, "glycosidic_ADJ": 0.41, "caloric_NOUN": 0.41, "vagus_NOUN": 0.41, "nonlinearity_NOUN": 0.41, "avulsed_ADJ": 0.41, "eNO_NOUN": 0.41, "ototoxicity_NOUN": 0.41, "tortilla_NOUN": 0.41, "psittacosis_NOUN": 0.41, "interplay_NOUN": 0.41, "migrant_ADJ": 0.4, "particularly_ADV": 0.4, "outweigh_VERB": 0.39, "lense_NOUN": 0.39, "osteochondroma_NOUN": 0.39, "influx_NOUN": 0.39, "microstructural_ADJ": 0.39, "existing_ADJ": 0.39, "isotopic_ADJ": 0.39, "promise_NOUN": 0.38, "traditional_ADJ": 0.38, "ultimately_ADV": 0.38, "biotransformation_NOUN": 0.36, "congestion_NOUN": 0.36, "coordinated_ADJ": 0.36, "intricate_ADJ": 0.36, "displacement_ADJ": 0.36, "inequity_NOUN": 0.36, "retina_NOUN": 0.36, "nanostructure_VERB": 0.36, "position_VERB": 0.36, "inferential_ADJ": 0.36, "accountability_NOUN": 0.36, "cryopreservation_NOUN": 0.36, "additionally_ADV": 0.36, "complexity_NOUN": 0.36, "bereavement_NOUN": 0.35, "emphasize_VERB": 0.35, "conversely_ADV": 0.35, "conservation_NOUN": 0.35, "immunomodulatory_ADJ": 0.34, "linguistic_ADJ": 0.34, "assimilation_NOUN": 0.34, "coexistence_NOUN": 0.34, "nanosheet_NOUN": 0.34, "rpm_NOUN": 0.34, "dysregulation_NOUN": 0.34, "bmsc_NOUN": 0.33, "centric_ADJ": 0.33, "commentary_NOUN": 0.33, "degrading_ADJ": 0.33, "agroforestry_NOUN": 0.33, "membranaceus_NOUN": 0.33, "cicadae_NOUN": 0.33, "inmate_NOUN": 0.33, "authority_NOUN": 0.33, "adjunctive_ADJ": 0.33, "distinctive_ADJ": 0.33, "symbiotic_ADJ": 0.33, "container_NOUN": 0.33, "adjunct_ADJ": 0.32, "monkey_NOUN": 0.32, "reprogramming_NOUN": 0.32, "allocation_NOUN": 0.32, "anxious_ADJ": 0.32, "ginger_NOUN": 0.32, "reevaluate_VERB": 0.32, "careful_ADJ": 0.31, "heavily_ADV": 0.31, "pharmacodynamic_NOUN": 0.31, "exacerbate_VERB": 0.31, "ingroup_NOUN": 0.31, "signaling_ADJ": 0.3, "versatility_NOUN": 0.3, "stacking_NOUN": 0.3, "fossa_ADJ": 0.3, "ampicillin_NOUN": 0.3, "occlude_VERB": 0.3, "subtle_ADJ": 0.3, "forum_NOUN": 0.3, "transplant_ADJ": 0.3, "amps_NOUN": 0.3, "percolation_NOUN": 0.3, "circumstance_NOUN": 0.3, "notable_ADJ": 0.3, "sharing_NOUN": 0.29, "informal_ADJ": 0.29, "designer_NOUN": 0.29, "fluoxetine_NOUN": 0.29, "api_NOUN": 0.29, "nano_NOUN": 0.29, "biotechnological_ADJ": 0.29, "pack_VERB": 0.29, "indicative_ADJ": 0.29, "regularly_ADV": 0.29, "dissect_VERB": 0.29, "eventually_ADV": 0.29, "specialist_ADJ": 0.29, "participant_ADJ": 0.28, "neurotransmitter_NOUN": 0.28, "specifically_ADV": 0.28, "menthol_NOUN": 0.28, "modulate_VERB": 0.28, "physics_NOUN": 0.27, "orbital_NOUN": 0.27, "pronounce_VERB": 0.27, "orthopedic_ADJ": 0.27, "paternal_ADJ": 0.27, "untranslated_ADJ": 0.27, "audiology_NOUN": 0.27, "bifunctional_ADJ": 0.27, "landfill_NOUN": 0.27, "myoclonus_NOUN": 0.27, "homeward_ADJ": 0.27, "shortage_NOUN": 0.27, "tailor_VERB": 0.27, "grape_NOUN": 0.26, "handling_NOUN": 0.26, "excitability_NOUN": 0.26, "qtl_NOUN": 0.26, "pronounced_ADJ": 0.26, "vis_NOUN": 0.26, "mosquito_ADJ": 0.25, "hinder_VERB": 0.25, "pomace_NOUN": 0.25, "warning_NOUN": 0.25, "curve_VERB": 0.25, "illuminant_NOUN": 0.25, "acknowledge_VERB": 0.25, "individualized_ADJ": 0.25, "conjunction_NOUN": 0.25, "artefact_NOUN": 0.25, "bioinformatics_NOUN": 0.25, "cervix_NOUN": 0.25, "radiologist_NOUN": 0.25, "photonic_ADJ": 0.25, "lvad_NOUN": 0.25, "mogroside_ADJ": 0.25, "fault_NOUN": 0.25, "hlf_NOUN": 0.25, "mrs_NOUN": 0.25, "minimize_VERB": 0.25, "electrode_ADJ": 0.25, "comprehensive_ADJ": 0.25, "remediation_NOUN": 0.24, "roughness_NOUN": 0.24, "account_NOUN": 0.24, "timescale_NOUN": 0.24, "fe_NOUN": 0.24, "sequencing_NOUN": 0.24, "dependency_NOUN": 0.24, "arthroscopy_NOUN": 0.24, "accessibility_NOUN": 0.24, "solely_ADV": 0.23, "foster_VERB": 0.23, "dct_NOUN": 0.23, "taxonomy_NOUN": 0.23, "facilitation_NOUN": 0.23, "pulp_NOUN": 0.23, "selectively_ADV": 0.23, "standardized_ADJ": 0.23, "workforce_NOUN": 0.23, "rely_VERB": 0.23, "norm_NOUN": 0.23, "such_ADJ": 0.23, "glandular_ADJ": 0.22, "debilitate_VERB": 0.22, "biogeochemical_ADJ": 0.22, "mump_NOUN": 0.22, "novice_NOUN": 0.22, "craniofacial_ADJ": 0.22, "unintended_ADJ": 0.22, "accreditation_NOUN": 0.22, "ownership_NOUN": 0.22, "bpa_NOUN": 0.22, "tele_NOUN": 0.22, "tumor_ADJ": 0.22, "actively_ADV": 0.22, "flavor_NOUN": 0.22, "empowerment_NOUN": 0.22, "stiffness_ADJ": 0.22, "regular_ADJ": 0.22, "creation_NOUN": 0.22, "respect_VERB": 0.22, "absorber_NOUN": 0.22, "malocclusion_NOUN": 0.22, "insight_NOUN": 0.22, "targeting_NOUN": 0.22, "exhibit_NOUN": 0.22, "disparity_NOUN": 0.22, "exponential_ADJ": 0.22, "olfactory_ADJ": 0.22, "picky_ADJ": 0.22, "dssc_NOUN": 0.22, "exhibit_VERB": 0.21, "importance_NOUN": 0.21, "subject_ADJ": 0.21, "targeted_ADJ": 0.21, "se_NOUN": 0.21, "floral_ADJ": 0.21, "vocalization_NOUN": 0.21, "informed_ADJ": 0.21, "educator_NOUN": 0.21, "essential_ADJ": 0.21, "resorption_NOUN": 0.21, "societal_ADJ": 0.2, "cingulate_NOUN": 0.2, "board_NOUN": 0.2, "complex_ADJ": 0.2, "dosing_NOUN": 0.2, "fully_ADV": 0.2, "neuroimage_VERB": 0.2, "target_VERB": 0.2, "similarly_ADV": 0.2, "venom_NOUN": 0.2, "certain_ADJ": 0.2, "hsc_NOUN": 0.2, "culturally_ADV": 0.2, "influential_ADJ": 0.2, "sol_ADJ": 0.2, "ordered_ADJ": 0.2, "actually_ADV": 0.2, "ionize_VERB": 0.2, "byproduct_NOUN": 0.2, "village_NOUN": 0.2, "clinician_ADJ": 0.2, "outlier_NOUN": 0.2, "confidentiality_NOUN": 0.2, "scaling_NOUN": 0.2, "racism_NOUN": 0.2, "hinge_NOUN": 0.2, "play_VERB": 0.19, "smoothing_NOUN": 0.19, "analytic_NOUN": 0.19, "transaminase_NOUN": 0.19, "ageing_NOUN": 0.19, "reduced_ADJ": 0.19, "accident_NOUN": 0.19, "customize_VERB": 0.19, "predisposition_NOUN": 0.19, "chromium_NOUN": 0.19, "need_NOUN": 0.19, "usability_NOUN": 0.19, "transparency_NOUN": 0.19, "certification_NOUN": 0.19, "specialized_ADJ": 0.19, "coastal_ADJ": 0.19, "judgment_NOUN": 0.19, "capture_VERB": 0.18, "precise_ADJ": 0.18, "understanding_NOUN": 0.18, "healthcare_NOUN": 0.18, "handle_VERB": 0.18, "sustainable_ADJ": 0.18, "aquatic_ADJ": 0.18, "optimization_NOUN": 0.18, "overall_ADV": 0.18, "photoreceptor_NOUN": 0.18, "hoc_ADJ": 0.18, "cuff_NOUN": 0.18, "combat_VERB": 0.18, "empathy_NOUN": 0.18, "play_NOUN": 0.18, "simulator_NOUN": 0.18, "bifactor_NOUN": 0.18, "sustainability_NOUN": 0.18, "vasodilation_NOUN": 0.18, "vacuum_NOUN": 0.18, "dopant_ADJ": 0.18, "dimensionality_NOUN": 0.18, "globin_NOUN": 0.18, "vitrification_NOUN": 0.18, "diatom_ADJ": 0.18, "explore_VERB": 0.17, "collaboration_NOUN": 0.17, "furthermore_ADV": 0.17, "critical_ADJ": 0.17, "rather_ADV": 0.17, "carefully_ADV": 0.17, "biologic_NOUN": 0.17, "various_ADJ": 0.17, "electro_NOUN": 0.17, "tend_VERB": 0.17, "evade_VERB": 0.17, "actual_ADJ": 0.17, "hardware_NOUN": 0.17, "multidisciplinary_ADJ": 0.17, "wireless_ADJ": 0.17, "newborn_ADJ": 0.17, "deceased_ADJ": 0.17, "filament_NOUN": 0.17, "friendly_ADJ": 0.17, "monitoring_NOUN": 0.17, "ancestor_NOUN": 0.17, "pre_VERB": 0.17, "culture_ADJ": 0.17, "cathepsin_NOUN": 0.17, "zwitterionic_ADJ": 0.17, "shed_VERB": 0.16, "pituitary_ADJ": 0.16, "aim_VERB": 0.16, "environmentally_ADV": 0.16, "relatively_ADV": 0.16, "thorough_ADJ": 0.16, "nutrient_NOUN": 0.16, "improved_ADJ": 0.16, "epigenetic_ADJ": 0.16, "cultural_ADJ": 0.16, "tick_NOUN": 0.16, "fluctuation_NOUN": 0.16, "innovative_ADJ": 0.16, "elucidate_VERB": 0.16, "pro_ADJ": 0.16, "limit_VERB": 0.16, "shape_VERB": 0.16, "implication_NOUN": 0.16, "counseling_NOUN": 0.16, "breastfeed_VERB": 0.16, "treatment_ADJ": 0.16, "solute_NOUN": 0.16, "gabapentinoid_NOUN": 0.16, "pharmacokinetic_NOUN": 0.15, "productivity_NOUN": 0.15, "potential_NOUN": 0.15, "prompt_VERB": 0.15, "keratin_NOUN": 0.15, "inherent_ADJ": 0.15, "explicitly_ADV": 0.15, "struggle_VERB": 0.15, "vicinity_NOUN": 0.15, "boundary_ADJ": 0.15, "latex_NOUN": 0.15, "bmo_NOUN": 0.15, "representative_ADJ": 0.15, "indigenous_ADJ": 0.15, "ensure_VERB": 0.15, "interconnect_VERB": 0.15, "grief_NOUN": 0.15, "crystallinity_NOUN": 0.15, "endodontic_ADJ": 0.15, "involve_VERB": 0.15, "suggest_VERB": 0.15, "incorporate_VERB": 0.15, "infrastructure_NOUN": 0.15, "socioeconomic_ADJ": 0.15, "optimize_VERB": 0.15, "oh_NOUN": 0.15, "simply_ADV": 0.15, "spa_NOUN": 0.15, "bevacizumab_NOUN": 0.15, "breeding_NOUN": 0.15, "contribute_VERB": 0.15, "offer_VERB": 0.15, "labor_NOUN": 0.15, "tissue_VERB": 0.15, "inadequate_ADJ": 0.15, "actuator_NOUN": 0.15, "incorporation_NOUN": 0.14, "sorption_NOUN": 0.14, "evolutionary_ADJ": 0.14, "ease_NOUN": 0.14, "renewal_NOUN": 0.14, "audit_NOUN": 0.14, "convergence_NOUN": 0.14, "regulation_NOUN": 0.14, "sea_NOUN": 0.14, "step_NOUN": 0.14, "initiative_NOUN": 0.14, "as_ADJ": 0.14, "encapsulation_NOUN": 0.14, "instance_NOUN": 0.14, "parasitic_ADJ": 0.14, "provider_NOUN": 0.14, "intermediate_NOUN": 0.14, "disruption_NOUN": 0.14, "spare_VERB": 0.14, "emotional_ADJ": 0.14, "being_NOUN": 0.14, "primarily_ADV": 0.14, "insect_NOUN": 0.14, "immunosuppressive_ADJ": 0.14, "caution_NOUN": 0.14, "clinician_NOUN": 0.14, "posture_NOUN": 0.14, "phantom_NOUN": 0.14, "concussion_NOUN": 0.14, "biophysical_ADJ": 0.14, "potentially_ADV": 0.14, "navigate_VERB": 0.14, "replicate_VERB": 0.14, "therapeutic_ADJ": 0.14, "challenge_VERB": 0.13, "adrenal_ADJ": 0.13, "address_VERB": 0.13, "integration_NOUN": 0.13, "mimic_VERB": 0.13, "diverse_ADJ": 0.13, "benefit_NOUN": 0.13, "scenario_NOUN": 0.13, "bioactivity_NOUN": 0.13, "nematode_NOUN": 0.13, "distraction_NOUN": 0.13, "fungal_NOUN": 0.13, "reconstructed_ADJ": 0.13, "applicability_NOUN": 0.13, "varied_ADJ": 0.13, "spread_NOUN": 0.13, "finding_NOUN": 0.13, "brown_ADJ": 0.13, "mitigation_NOUN": 0.13, "cortisol_NOUN": 0.13, "optoelectronic_ADJ": 0.13, "lead_VERB": 0.13, "mesh_NOUN": 0.13, "balance_VERB": 0.13, "coach_NOUN": 0.13, "payment_NOUN": 0.13, "expectancy_NOUN": 0.13, "poverty_NOUN": 0.13, "wean_VERB": 0.13, "prey_NOUN": 0.13, "availability_NOUN": 0.13, "strategy_NOUN": 0.13, "effectiveness_NOUN": 0.13, "fmri_NOUN": 0.13, "gather_VERB": 0.13, "filter_VERB": 0.13, "employ_VERB": 0.13, "uniform_ADJ": 0.13, "motivate_VERB": 0.13, "prompt_ADJ": 0.13, "experience_VERB": 0.13, "well_NOUN": 0.12, "individual_ADJ": 0.12, "balanced_ADJ": 0.12, "slow_VERB": 0.12, "fibrotic_ADJ": 0.12, "beneficial_ADJ": 0.12, "geographic_ADJ": 0.12, "limitation_NOUN": 0.12, "enable_VERB": 0.12, "evidence_VERB": 0.12, "regardless_ADV": 0.12, "commitment_NOUN": 0.12, "evasion_NOUN": 0.12, "maintain_VERB": 0.12, "pathway_ADV": 0.12, "angiogenesis_NOUN": 0.12, "categorize_VERB": 0.12, "smear_NOUN": 0.12, "veterinary_ADJ": 0.12, "benefit_VERB": 0.12, "cardiovascular_ADJ": 0.12, "involvement_NOUN": 0.12, "significant_ADJ": 0.12, "variability_NOUN": 0.12, "awareness_NOUN": 0.12, "further_ADJ": 0.12, "influence_VERB": 0.12, "policy_NOUN": 0.12, "vibration_NOUN": 0.12, "axonal_ADJ": 0.12, "intramolecular_ADJ": 0.12, "effectively_ADV": 0.12, "compromise_VERB": 0.12, "flat_ADJ": 0.12, "value_VERB": 0.12, "radical_NOUN": 0.12, "voice_NOUN": 0.12, "resilient_ADJ": 0.12, "perturbation_NOUN": 0.12, "robustness_NOUN": 0.12, "ill_ADJ": 0.12, "antioxidant_ADJ": 0.12, "researcher_NOUN": 0.12, "preservation_NOUN": 0.12, "microorganism_NOUN": 0.12, "mention_VERB": 0.12, "bacillus_NOUN": 0.11, "ongoing_ADJ": 0.11, "alignment_NOUN": 0.11, "biogenesis_NOUN": 0.11, "skilled_ADJ": 0.11, "motivation_NOUN": 0.11, "variant_ADJ": 0.11, "expertise_NOUN": 0.11, "several_ADJ": 0.11, "manage_VERB": 0.11, "potential_ADJ": 0.11, "discovery_NOUN": 0.11, "setup_NOUN": 0.11, "exclusion_NOUN": 0.11, "marital_ADJ": 0.11, "expectation_NOUN": 0.11, "accurately_ADV": 0.11, "postpartum_NOUN": 0.11, "socio_NOUN": 0.11, "onto_ADP": 0.11, "genetic_ADJ": 0.11, "supportive_ADJ": 0.11, "our_PRON": 0.11, "κb_NOUN": 0.11, "investigate_VERB": 0.11, "typically_ADV": 0.11, "flexibility_NOUN": 0.11, "confound_VERB": 0.11, "periodic_ADJ": 0.11, "minimal_ADJ": 0.11, "catenin_ADJ": 0.11, "pitch_NOUN": 0.11, "nash_NOUN": 0.11, "stakeholder_NOUN": 0.11, "campaign_NOUN": 0.11, "mathematical_ADJ": 0.11, "incentive_NOUN": 0.11, "disposal_NOUN": 0.11, "autonomic_ADJ": 0.11, "hygiene_NOUN": 0.11, "concern_NOUN": 0.11, "usage_NOUN": 0.11, "mobilization_NOUN": 0.11, "bioavailability_NOUN": 0.11, "radiology_NOUN": 0.11, "bleed_VERB": 0.1, "histopathological_ADJ": 0.1, "mechanistic_ADJ": 0.1, "imply_VERB": 0.1, "recognition_NOUN": 0.1, "stiffness_NOUN": 0.1, "elongation_NOUN": 0.1, "qrt_ADJ": 0.1, "possess_VERB": 0.1, "tracking_NOUN": 0.1, "vulnerable_ADJ": 0.1, "promote_VERB": 0.1, "thinking_NOUN": 0.1, "operator_NOUN": 0.1, "restrictive_ADJ": 0.1, "development_NOUN": 0.1, "coordinate_VERB": 0.1, "salinity_NOUN": 0.1, "advancement_NOUN": 0.1, "planning_NOUN": 0.1, "habitat_NOUN": 0.1, "viable_ADJ": 0.1, "approach_NOUN": 0.1, "ecosystem_NOUN": 0.1, "behavioral_ADJ": 0.1, "hair_NOUN": 0.1, "moreover_ADV": 0.1, "collaborative_ADJ": 0.1, "notion_NOUN": 0.1, "rheological_ADJ": 0.1, "fatty_ADJ": 0.1, "acetylation_NOUN": 0.1, "algorithm_NOUN": 0.1, "comorbiditie_NOUN": 0.1, "protective_ADJ": 0.1, "dynamic_NOUN": 0.1, "exert_VERB": 0.1, "repetitive_ADJ": 0.1, "iodine_NOUN": 0.1, "engage_VERB": 0.1, "supplement_NOUN": 0.1, "regulatory_ADJ": 0.1, "angiogenic_ADJ": 0.1, "inform_VERB": 0.1, "juvenile_ADJ": 0.1, "psychosis_NOUN": 0.1, "technical_ADJ": 0.1, "accessible_ADJ": 0.1, "voc_NOUN": 0.1, "individual_NOUN": 0.1, "standardize_VERB": 0.1, "patient_ADJ": 0.1, "modulation_NOUN": 0.1, "nematode_ADJ": 0.09, "debate_NOUN": 0.09, "elevated_ADJ": 0.09, "pupil_NOUN": 0.09, "monitor_VERB": 0.09, "pose_VERB": 0.09, "suppressor_NOUN": 0.09, "neurodegenerative_ADJ": 0.09, "consistent_ADJ": 0.09, "industrial_ADJ": 0.09, "reproductive_ADJ": 0.09, "entity_NOUN": 0.09, "attractive_ADJ": 0.09, "challenge_NOUN": 0.09, "synergistic_ADJ": 0.09, "despite_SCONJ": 0.09, "accurate_ADJ": 0.09, "context_NOUN": 0.09, "efflux_NOUN": 0.09, "gaze_NOUN": 0.09, "bias_NOUN": 0.09, "investment_NOUN": 0.09, "modification_NOUN": 0.09, "dry_VERB": 0.09, "synaptic_ADJ": 0.09, "anatomical_ADJ": 0.09, "fibril_NOUN": 0.09, "infected_ADJ": 0.09, "enhance_VERB": 0.09, "formal_ADJ": 0.09, "facilitate_VERB": 0.09, "remote_ADJ": 0.09, "just_ADV": 0.09, "characterization_NOUN": 0.09, "underlying_ADJ": 0.09, "mechanism_NOUN": 0.09, "center_VERB": 0.09, "surround_VERB": 0.09, "reliable_ADJ": 0.09, "machine_NOUN": 0.09, "optimal_ADJ": 0.09, "favorable_ADJ": 0.09, "photosynthesis_NOUN": 0.09, "switch_NOUN": 0.09, "music_NOUN": 0.09, "numerous_ADJ": 0.09, "neuroprotective_ADJ": 0.09, "disrupt_VERB": 0.09, "conformational_ADJ": 0.09, "toxin_NOUN": 0.09, "elasticity_NOUN": 0.09, "arrangement_NOUN": 0.09, "contaminated_ADJ": 0.09, "dominance_NOUN": 0.09, "attenuation_NOUN": 0.09, "effective_ADJ": 0.09, "correlation_NOUN": 0.09, "allow_VERB": 0.08, "inflammatory_ADJ": 0.08, "result_VERB": 0.08, "identification_NOUN": 0.08, "regimen_NOUN": 0.08, "environmental_ADJ": 0.08, "processing_NOUN": 0.08, "microstructure_NOUN": 0.08, "coagulation_NOUN": 0.08, "biodiversity_NOUN": 0.08, "drought_NOUN": 0.08, "timely_ADJ": 0.08, "realistic_ADJ": 0.08, "necessary_ADJ": 0.08, "neural_ADJ": 0.08, "fit_NOUN": 0.08, "impaired_ADJ": 0.08, "where_SCONJ": 0.08, "horizontal_ADJ": 0.08, "prone_ADJ": 0.08, "diversity_NOUN": 0.08, "visualize_VERB": 0.08, "likely_ADV": 0.08, "may_AUX": 0.08, "economic_ADJ": 0.08, "pollution_NOUN": 0.08, "combination_NOUN": 0.08, "foundation_NOUN": 0.08, "timing_NOUN": 0.08, "adoption_NOUN": 0.08, "accuracy_NOUN": 0.08, "rating_NOUN": 0.08, "cycling_NOUN": 0.08, "fertilizer_NOUN": 0.08, "create_VERB": 0.08, "refractive_ADJ": 0.08, "ser_NOUN": 0.08, "attentional_ADJ": 0.08, "cellular_ADJ": 0.08, "functioning_NOUN": 0.08, "assessment_NOUN": 0.08, "dairy_NOUN": 0.08, "solubility_NOUN": 0.08, "machinery_NOUN": 0.08, "attribute_VERB": 0.08, "auditory_ADJ": 0.08, "competence_NOUN": 0.08, "detrimental_ADJ": 0.08, "desire_NOUN": 0.08, "another_DET": 0.08, "connection_NOUN": 0.08, "pathway_NOUN": 0.08, "pharmaceutical_NOUN": 0.08, "extensively_ADV": 0.08, "personnel_NOUN": 0.08, "decision_NOUN": 0.08, "management_NOUN": 0.08, "limited_ADJ": 0.08, "indicate_VERB": 0.08, "biocompatibility_NOUN": 0.07, "making_NOUN": 0.07, "infer_VERB": 0.07, "improvement_NOUN": 0.07, "demand_NOUN": 0.07, "these_DET": 0.07, "sense_NOUN": 0.07, "key_ADJ": 0.07, "rural_ADJ": 0.07, "distinct_ADJ": 0.07, "emergence_NOUN": 0.07, "suppression_NOUN": 0.07, "impact_NOUN": 0.07, "pattern_NOUN": 0.07, "vary_VERB": 0.07, "degradation_NOUN": 0.07, "efficient_ADJ": 0.07, "greenhouse_NOUN": 0.07, "blotting_NOUN": 0.07, "integrity_NOUN": 0.07, "cue_NOUN": 0.07, "simulate_VERB": 0.07, "setting_NOUN": 0.07, "outperform_VERB": 0.07, "tool_NOUN": 0.07, "gut_NOUN": 0.07, "unique_ADJ": 0.07, "homeostasis_NOUN": 0.07, "contamination_NOUN": 0.07, "stability_NOUN": 0.07, "employment_NOUN": 0.07, "assume_VERB": 0.07, "relationship_NOUN": 0.07, "interaction_NOUN": 0.07, "technology_NOUN": 0.07, "consider_VERB": 0.07, "like_ADP": 0.07, "wavelength_NOUN": 0.07, "transmission_NOUN": 0.07, "testing_NOUN": 0.07, "fungal_ADJ": 0.07, "cytokine_NOUN": 0.07, "reduce_VERB": 0.07, "aggressive_ADJ": 0.07, "defense_NOUN": 0.07, "pharmacy_NOUN": 0.07, "flood_NOUN": 0.07, "preterm_NOUN": 0.07, "feasibility_NOUN": 0.07, "thematic_ADJ": 0.07, "into_ADP": 0.07, "mechanical_ADJ": 0.07, "equipment_NOUN": 0.07, "application_NOUN": 0.07, "implementation_NOUN": 0.07, "biochemical_ADJ": 0.07, "damage_NOUN": 0.07, "prior_ADJ": 0.07, "find_VERB": 0.07, "formulation_NOUN": 0.07, "phenomenon_NOUN": 0.07, "specific_ADJ": 0.06, "more_ADV": 0.06, "open_VERB": 0.06, "convolutional_ADJ": 0.06, "skill_NOUN": 0.06, "regeneration_NOUN": 0.06, "telemedicine_NOUN": 0.06, "property_NOUN": 0.06, "molecular_ADJ": 0.06, "widespread_ADJ": 0.06, "centre_NOUN": 0.06, "conduction_NOUN": 0.06, "μg_NOUN": 0.06, "option_NOUN": 0.06, "contrast_NOUN": 0.06, "precision_NOUN": 0.06, "serve_VERB": 0.06, "sustained_ADJ": 0.06, "recognize_VERB": 0.06, "ring_NOUN": 0.06, "biomarker_NOUN": 0.06, "mirnas_NOUN": 0.06, "while_SCONJ": 0.06, "theme_NOUN": 0.06, "measure_NOUN": 0.06, "elevate_VERB": 0.06, "that_SCONJ": 0.06, "agricultural_ADJ": 0.06, "resource_NOUN": 0.06, "lack_NOUN": 0.06, "qualitative_ADJ": 0.06, "supplementation_NOUN": 0.06, "throughput_NOUN": 0.06, "excessive_ADJ": 0.06, "impair_VERB": 0.06, "size_NOUN": 0.06, "funding_NOUN": 0.06, "communication_NOUN": 0.06, "evolve_VERB": 0.06, "role_NOUN": 0.06, "understand_VERB": 0.06, "for_SCONJ": 0.06, "improve_VERB": 0.06, "modeling_NOUN": 0.06, "autoimmune_ADJ": 0.06, "evolution_NOUN": 0.06, "immune_ADJ": 0.06, "engagement_NOUN": 0.06, "framework_NOUN": 0.06, "intervention_NOUN": 0.06, "prevent_VERB": 0.06, "face_VERB": 0.06, "liquid_ADJ": 0.06, "outcome_NOUN": 0.06, "utilize_VERB": 0.06, "causal_ADJ": 0.06, "validate_VERB": 0.06, "fluid_ADJ": 0.06, "musculoskeletal_ADJ": 0.06, "result_NOUN": 0.06, "efficiency_NOUN": 0.06, "shift_NOUN": 0.06, "characteristic_ADJ": 0.06, "reveal_VERB": 0.06, "staff_NOUN": 0.06, "hormone_NOUN": 0.06, "behavior_NOUN": 0.06, "its_PRON": 0.06, "presentation_NOUN": 0.05, "consistency_NOUN": 0.05, "calibration_NOUN": 0.05, "spectral_ADJ": 0.05, "functional_ADJ": 0.05, "study_NOUN": 0.05, "balance_NOUN": 0.05, "antimicrobial_ADJ": 0.05, "subsequent_ADJ": 0.05, "powder_NOUN": 0.05, "cortical_ADJ": 0.05, "table_NOUN": 0.05, "severity_NOUN": 0.05, "prevention_NOUN": 0.05, "computational_ADJ": 0.05, "reconstruct_VERB": 0.05, "efficacy_NOUN": 0.05, "humidity_NOUN": 0.05, "ligand_NOUN": 0.05, "nutrient_ADJ": 0.05, "symptom_NOUN": 0.05, "scan_NOUN": 0.05, "education_NOUN": 0.05, "potato_NOUN": 0.05, "pesticide_NOUN": 0.05, "protocol_NOUN": 0.05, "crop_NOUN": 0.05, "pediatric_ADJ": 0.05, "adaptation_NOUN": 0.05, "inclusion_NOUN": 0.05, "diagnostic_ADJ": 0.05, "translation_NOUN": 0.05, "velocity_NOUN": 0.05, "access_NOUN": 0.05, "morphology_NOUN": 0.05, "affected_ADJ": 0.05, "axis_NOUN": 0.05, "restore_VERB": 0.05, "real_ADJ": 0.05, "public_ADJ": 0.05, "objective_ADJ": 0.05, "support_NOUN": 0.05, "electrochemical_ADJ": 0.05, "aspect_NOUN": 0.05, "powerful_ADJ": 0.05, "urban_ADJ": 0.05, "recurrent_ADJ": 0.05, "retinal_ADJ": 0.05, "gait_NOUN": 0.05, "oxidative_ADJ": 0.05, "responsive_ADJ": 0.05, "structural_ADJ": 0.05, "gap_NOUN": 0.05, "enzyme_NOUN": 0.05, "habit_NOUN": 0.05, "adapt_VERB": 0.05, "analytical_ADJ": 0.05, "adaptive_ADJ": 0.05, "due_ADP": 0.05, "enhanced_ADJ": 0.05, "characteristic_NOUN": 0.05, "waste_NOUN": 0.05, "inflammation_NOUN": 0.05, "addiction_NOUN": 0.05, "heterogeneity_NOUN": 0.05, "training_NOUN": 0.05, "technique_NOUN": 0.05, "implicate_VERB": 0.05, "sequence_VERB": 0.05, "affinity_NOUN": 0.05, "physiological_ADJ": 0.05, "guideline_NOUN": 0.05, "complication_NOUN": 0.05, "investigation_NOUN": 0.05, "player_NOUN": 0.05, "as_ADP": 0.05, "filter_NOUN": 0.05, "can_AUX": 0.05, "cognitive_ADJ": 0.05, "metric_NOUN": 0.05, "surveillance_NOUN": 0.05, "climate_NOUN": 0.05, "regulate_VERB": 0.05, "performance_NOUN": 0.04, "supply_NOUN": 0.04, "deposition_NOUN": 0.04, "microenvironment_NOUN": 0.04, "professional_NOUN": 0.04, "similarity_NOUN": 0.04, "demonstrate_VERB": 0.04, "function_NOUN": 0.04, "anti_ADJ": 0.04, "repair_NOUN": 0.04, "recipient_NOUN": 0.04, "subject_VERB": 0.04, "exist_VERB": 0.04, "biology_NOUN": 0.04, "measurement_NOUN": 0.04, "engineering_NOUN": 0.04, "long_ADJ": 0.04, "language_NOUN": 0.04, "co_NOUN": 0.04, "program_NOUN": 0.04, "component_NOUN": 0.04, "criterion_NOUN": 0.04, "include_VERB": 0.04, "effort_NOUN": 0.04, "alternative_ADJ": 0.04, "production_NOUN": 0.04, "population_NOUN": 0.04, "future_ADJ": 0.04, "progression_NOUN": 0.04, "subtype_NOUN": 0.04, "focus_VERB": 0.04, "hybrid_ADJ": 0.04, "make_VERB": 0.04, "reliability_NOUN": 0.04, "social_ADJ": 0.04, "account_VERB": 0.04, "surgeon_NOUN": 0.04, "dental_ADJ": 0.04, "multi_ADJ": 0.04, "breed_NOUN": 0.04, "nature_NOUN": 0.04, "fact_NOUN": 0.04, "process_NOUN": 0.04, "widely_ADV": 0.04, "fertility_NOUN": 0.04, "material_NOUN": 0.04, "depend_VERB": 0.04, "hearing_NOUN": 0.04, "interpret_VERB": 0.04, "replication_NOUN": 0.04, "stress_NOUN": 0.04, "caregiver_NOUN": 0.04, "sensitivity_NOUN": 0.04, "alteration_NOUN": 0.04, "consist_VERB": 0.04, "close_ADJ": 0.04, "emotion_NOUN": 0.04, "advanced_ADJ": 0.04, "model_VERB": 0.04, "genomic_ADJ": 0.04, "need_VERB": 0.04, "term_NOUN": 0.04, "mutation_NOUN": 0.04, "software_NOUN": 0.04, "digital_ADJ": 0.04, "suitable_ADJ": 0.04, "disability_NOUN": 0.04, "binding_NOUN": 0.04, "preference_NOUN": 0.04, "attitude_NOUN": 0.04, "antibiotic_NOUN": 0.04, "post_ADJ": 0.04, "use_NOUN": 0.04, "apoptosis_NOUN": 0.04, "image_VERB": 0.04, "overcome_VERB": 0.04, "dataset_NOUN": 0.04, "representation_NOUN": 0.04, "approximately_ADV": 0.03, "therapy_NOUN": 0.03, "surface_NOUN": 0.03, "this_PRON": 0.03, "susceptibility_NOUN": 0.03, "predictive_ADJ": 0.03, "environment_NOUN": 0.03, "mobility_NOUN": 0.03, "validation_NOUN": 0.03, "potent_ADJ": 0.03, "aware_ADJ": 0.03, "fitness_NOUN": 0.03, "developmental_ADJ": 0.03, "rapid_ADJ": 0.03, "storage_NOUN": 0.03, "laboratory_NOUN": 0.03, "other_ADJ": 0.03, "consideration_NOUN": 0.03, "as_SCONJ": 0.03, "nitrogen_NOUN": 0.03, "sensor_NOUN": 0.03, "integrate_VERB": 0.03, "early_ADJ": 0.03, "viral_ADJ": 0.03, "asthma_NOUN": 0.03, "tolerance_NOUN": 0.03, "robust_ADJ": 0.03, "imaging_NOUN": 0.03, "utility_NOUN": 0.03, "provide_VERB": 0.03, "specificity_NOUN": 0.03, "practice_NOUN": 0.03, "transfer_NOUN": 0.03, "design_VERB": 0.03, "factor_NOUN": 0.03, "reduction_NOUN": 0.03, "position_NOUN": 0.03, "mental_ADJ": 0.03, "take_VERB": 0.03, "user_NOUN": 0.03, "towards_ADP": 0.03, "color_NOUN": 0.03, "selection_NOUN": 0.03, "microbiome_NOUN": 0.03, "region_NOUN": 0.03, "train_VERB": 0.03, "treatment_NOUN": 0.03, "subgroup_NOUN": 0.03, "resistance_NOUN": 0.03, "also_ADV": 0.03, "mediate_VERB": 0.03, "direction_NOUN": 0.03, "profile_NOUN": 0.03, "success_NOUN": 0.03, "response_NOUN": 0.03, "multiple_ADJ": 0.03, "risk_NOUN": 0.03, "detailed_ADJ": 0.03, "across_ADP": 0.03, "platform_NOUN": 0.03, "trait_NOUN": 0.03, "ability_NOUN": 0.03, "pre_ADJ": 0.03, "channel_NOUN": 0.03, "safety_NOUN": 0.03, "develop_VERB": 0.03, "marker_NOUN": 0.03, "over_ADP": 0.03, "alternative_NOUN": 0.03, "action_NOUN": 0.03, "temporal_ADJ": 0.03, "structure_NOUN": 0.03, "coefficient_NOUN": 0.03, "examination_NOUN": 0.03, "even_ADV": 0.03, "signal_VERB": 0.03, "medication_NOUN": 0.03, "which_PRON": 0.03, "example_NOUN": 0.03, "formation_NOUN": 0.03, "mixed_ADJ": 0.03, "evaluation_NOUN": 0.03, "change_NOUN": 0.03, "both_DET": 0.03, "far_ADV": 0.03, "composition_NOUN": 0.03, "dysfunction_NOUN": 0.03, "hand_NOUN": 0.03, "status_NOUN": 0.03, "against_ADP": 0.03, "conclude_VERB": 0.02, "quantitative_ADJ": 0.02, "compound_NOUN": 0.02, "note_VERB": 0.02, "effect_NOUN": 0.02, "show_VERB": 0.02, "post_NOUN": 0.02, "system_NOUN": 0.02, "release_NOUN": 0.02, "implement_VERB": 0.02, "device_NOUN": 0.02, "activation_NOUN": 0.02, "agent_NOUN": 0.02, "gene_NOUN": 0.02, "degree_NOUN": 0.02, "condition_NOUN": 0.02, "feature_NOUN": 0.02, "between_ADP": 0.02, "presence_NOUN": 0.02, "through_ADP": 0.02, "perception_NOUN": 0.02, "detection_NOUN": 0.02, "radiation_NOUN": 0.02, "sample_NOUN": 0.02, "inhibition_NOUN": 0.02, "period_NOUN": 0.02, "predict_VERB": 0.02, "previous_ADJ": 0.02, "propose_VERB": 0.02, "confirm_VERB": 0.02, "birth_NOUN": 0.02, "sex_NOUN": 0.02, "compare_VERB": 0.02, "complex_NOUN": 0.02, "analyze_VERB": 0.02, "disorder_NOUN": 0.02, "therefore_ADV": 0.02, "area_NOUN": 0.02, "well_ADJ": 0.02, "achieve_VERB": 0.02, "predictor_NOUN": 0.02, "highly_ADV": 0.02, "surgical_ADJ": 0.02, "growth_NOUN": 0.02, "often_ADV": 0.02, "health_NOUN": 0.02, "exposure_NOUN": 0.02, "analysis_NOUN": 0.02, "experience_NOUN": 0.02, "however_ADV": 0.02, "exercise_NOUN": 0.02, "their_PRON": 0.02, "loss_NOUN": 0.02, "undergo_VERB": 0.02, "procedure_NOUN": 0.02, "quality_NOUN": 0.02, "overall_ADJ": 0.02, "physical_ADJ": 0.02, "small_ADJ": 0.02, "novel_ADJ": 0.01, "as_ADV": 0.01, "have_VERB": 0.01, "evaluate_VERB": 0.01, "activity_NOUN": 0.01, "expression_NOUN": 0.01, "only_ADV": 0.01, "plant_NOUN": 0.01, "temperature_NOUN": 0.01, "diagnosis_NOUN": 0.01, "for_ADP": 0.01, "non_ADJ": 0.01, "model_NOUN": 0.01, "positive_ADJ": 0.01, "have_AUX": 0.01, "identify_VERB": 0.01, "to_ADP": 0.01, "disease_NOUN": 0.01, "to_PART": 0.01, "level_NOUN": 0.01, "research_NOUN": 0.01, "of_ADP": 0.002}


class LlamaTextProcessor:
    """
    A class to handle text processing, model initialization, and text generation
    using the Llama model.
    """

    def __init__(self, model_name, hf_token):
        """
        Initialize the tokenizer and model, and configure device settings.

        Parameters:
            model_name (str): The name of the model to load.
            hf_token (str): Hugging Face API token for authentication.
        """
        self.device = torch.device("cuda" if torch.cuda.is_available() else "cpu")
        print(f"Using {'GPU: ' + torch.cuda.get_device_name(0) if torch.cuda.is_available() else 'CPU'}")

        # Initialize tokenizer and model
        self.tokenizer = AutoTokenizer.from_pretrained(model_name, token=hf_token)
        self.model = AutoModelForCausalLM.from_pretrained(model_name, token=hf_token)

        # Ensure pad token is set
        if self.tokenizer.pad_token is None:
            if self.tokenizer.eos_token:
                self.tokenizer.pad_token = self.tokenizer.eos_token
            else:
                self.tokenizer.add_special_tokens({'pad_token': '[PAD]'})

        # Resize embeddings and move model to the appropriate device
        self.model.resize_token_embeddings(len(self.tokenizer))
        self.model.to(self.device)

        # Set padding token ID
        self.model.config.pad_token_id = self.tokenizer.pad_token_id


    def calculate_normalized_entropy(self, sentence):
        """
        Calculate the normalized entropy of a given sentence.

        Parameters:
            sentence (str): The input sentence to calculate entropy for.

        Returns:
            float: The normalized entropy value.
        """
        try:
            sentence = sentence.strip()
            # Encode the input sentence
            inputs = self.tokenizer(sentence, return_tensors="pt", padding=True).to(self.device)
            
            input_ids = inputs.input_ids
            num_tokens = input_ids.size(1)
            
            # Get model outputs (logits)
            with torch.no_grad():
                outputs = self.model(**inputs).logits
            
            # Shift the logits and input IDs for next-token prediction
            shift_logits = outputs[:, :-1, :]  # Remove last token's logits
            shift_labels = input_ids[:, 1:]    # Remove first token for labels
            
            # Softmax to convert logits to probabilities for next-token prediction
            probabilities = torch.softmax(shift_logits, dim=-1)
            
            # Gather probabilities of the correct next tokens
            target_probs = torch.gather(probabilities, dim=-1, index=shift_labels.unsqueeze(-1)).squeeze(-1)
            
            # Calculate entropy: -sum(p * log2(p))
            token_entropy = -torch.log2(target_probs + 1e-9)  # Add small epsilon to avoid log(0)
            total_entropy = torch.sum(token_entropy).item()
            
            # Normalize entropy by the number of tokens
            normalized_entropy = total_entropy / num_tokens
            return normalized_entropy
        except Exception as e:
            print(f"Error calculating entropy for sentence: {sentence}")
            print(e)
            return 100.0



# POS tag function
def pos_tag_sentence(sentence):
    doc = nlp(sentence)
    tagged_sentence = " ".join([f"{token.lemma_}_{token.pos_}" for token in doc])
    return tagged_sentence


def count_words_based_on_pos(tagged_sentence):
    """
    Count the number of words in a POS-tagged sentence, excluding specific categories.
    """
    words = tagged_sentence.split()
    # Exclude words containing specific POS tags
    excluded_tags = ["_PUNCT", "_SYM", "_NUM"]
    word_count = sum(1 for word in words if not any(keyword in word for keyword in excluded_tags))
    return word_count


def score_focal_words(tagged_sentence):
    focal_word_score = 0.0
    words = tagged_sentence.split()
    focal_word_score = sum(buzzword_weights[word] for word in words if word in buzzword_weights)
    return focal_word_score


HF_TOKEN = "hf_..." # Replace with your Hugging Face token
MODEL_NAME = "meta-llama/Llama-3.2-3B-Instruct"  # Llama-3.2-3B-Instruct
# Initialize model processor
model_processor = LlamaTextProcessor(MODEL_NAME, HF_TOKEN)

# Read the TSV file
input_file = "../data/experimental_items/50_sample_2020_ai_abstracts_cleaned.tsv"  # Replace with your file name
output_file = "../data/experimental_items/50_sample_2020_ai_abstracts_annotated.tsv"  # Replace with your desired output file name

# Read the TSV file into a list of lines
with open(input_file, "r", encoding="utf-8") as file:
    lines = file.readlines()

# Process and format the data
formatted_data = []

# Iterate over each line and split it into 100 variants
for line_index, line in enumerate(lines, start=1):
    variants = line.strip().split("\t")
    formatted_data.extend([(f"sentence_{line_index}", variant) for variant in variants])

# Convert to a DataFrame for easier writing
df = pd.DataFrame(formatted_data, columns=["Sentence", "Variant"])

# Add POS-tagged column once
df["POS_tagged"] = df["Variant"].apply(pos_tag_sentence)  # Add POS tags

# Print number of rows before filtering
print(f"Number of rows before filtering: {len(df)}")

# Drop rows that contain specific words
df = df[~df["POS_tagged"].str.contains("delve_VERB|showcase_VERB|underscore_VERB|surpass_VERB|comprehend_VERB|boast_VERB|emphasize_VERB|garner_VERB|align_VERB|intricate_ADJ|groundbreaking_ADJ|intricacy_NOUN|realm_NOUN|advancement_NOUN")]

# Print number of rows after filtering
print(f"Number of rows after filtering: {len(df)}")

# Calculate word count excluding punctuation, symbols, and numbers
df["Word_count"] = df["POS_tagged"].apply(count_words_based_on_pos)

# Filter rows based on word count
df = df[(df["Word_count"] >= 90) & (df["Word_count"] <= 110)]

# Print number of rows after word count filtering
print(f"Number of rows after word count filtering: {len(df)}")

# Use the precomputed POS-tagged column to count focal words
df["Focal_words"] = df["POS_tagged"].apply(score_focal_words)  # Count number of focal words

# Print the number of unique Sentence categories
unique_sentence_count = df["Sentence"].nunique()
print(f"Number of unique Sentence categories: {unique_sentence_count}")

df["Entropy_normalised"] = df["Variant"].apply(model_processor.calculate_normalized_entropy)  # Get normalized entropy

# Save the annotated output
df.to_csv(output_file, sep="\t", index=False, header=False)

print(f"Annotated output saved to {output_file}")
